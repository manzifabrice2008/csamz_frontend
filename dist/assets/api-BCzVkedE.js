import{g as f,a as T}from"./auth-yvpDPXXe.js";const h="http://localhost:13642/api";async function s(e,t={}){var i;const n=f(),r={};!(t.body instanceof FormData)&&!((i=t.headers)!=null&&i["Content-Type"])&&(r["Content-Type"]="application/json"),n&&(r.Authorization=`Bearer ${n}`);try{const a=await fetch(`${h}${e}`,{...t,headers:{...r,...t.headers}}),y=a.headers.get("content-type");let d;if(y&&y.includes("application/json"))d=await a.json();else if(d=await a.text(),d)try{d=JSON.parse(d)}catch{}if(a.status===401)throw T(),window.location.href="/admin/login",new Error("Session expired. Please login again.");if(!a.ok)throw new Error(d&&d.message||typeof d=="string"&&d||`API request failed with status ${a.status}`);return d}catch(a){throw a instanceof Error?a:new Error("Network error. Please check your connection.")}}const w={getPublished:async()=>s("/blog"),getBySlug:async e=>s(`/blog/${e}`),adminList:async()=>s("/blog/admin"),adminGetById:async e=>s(`/blog/admin/${e}`),create:async e=>s("/blog",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>s(`/blog/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>s(`/blog/${e}`,{method:"DELETE"})},b={getAll:async()=>s("/news"),getById:async e=>s(`/news/${e}`),async create(e){const t={...e,image_urls:e.image_urls||[]};return s("/news",{method:"POST",body:JSON.stringify(t)})},async update(e,t){const n=t.image_urls?{...t,image_urls:t.image_urls}:t;return s(`/news/${e}`,{method:"PUT",body:JSON.stringify(n)})},delete:async e=>s(`/news/${e}`,{method:"DELETE"})},l="studentAuthToken",m="studentUser",u={getToken(){return localStorage.getItem(l)},setToken(e){localStorage.setItem(l,e)},clearToken(){localStorage.removeItem(l)},getUser(){const e=localStorage.getItem(m);if(!e)return null;try{return JSON.parse(e)}catch{return null}},setUser(e){localStorage.setItem(m,JSON.stringify(e))},clearUser(){localStorage.removeItem(m)}},c=async(e,t={})=>{const n=u.getToken(),r={"Content-Type":"application/json",...t.headers};n&&(r.Authorization=`Bearer ${n}`);const i=await fetch(`${h}${e}`,{...t,headers:r}),a=await i.json();if(!i.ok)throw new Error(a.message||"Request failed");return a},O={register:async e=>{const t=await s("/student/auth/register",{method:"POST",body:JSON.stringify(e)});return t.success&&(u.setToken(t.token),u.setUser(t.student)),t},login:async e=>{const t=await s("/student/auth/login",{method:"POST",body:JSON.stringify(e)});return t.success&&(u.setToken(t.token),u.setUser(t.student)),t},logout:()=>{u.clearToken(),u.clearUser()},getCurrentStudent:async()=>c("/student/auth/me"),getStoredStudent:()=>u.getUser(),isAuthenticated:()=>!!u.getToken(),updateProfile:async e=>{const t=await c("/student/profile",{method:"PATCH",body:JSON.stringify(e)});if(t.success){const n=u.getUser();n&&u.setUser({...n,...t.student})}return t},changePassword:async e=>c("/student/change-password",{method:"POST",body:JSON.stringify(e)})},E={getAll:async e=>{const t=new URLSearchParams;e!=null&&e.status&&t.append("status",e.status),e!=null&&e.program&&t.append("program",e.program);const n=t.toString();return s(`/applications${n?"?"+n:""}`)},getById:async e=>s(`/applications/${e}`),create:async e=>{if(e.report){const t=new FormData;return Object.entries(e).forEach(([n,r])=>{n!=="report"&&r!==void 0&&t.append(n,r)}),t.append("report",e.report),s("/applications",{method:"POST",body:t,headers:{}})}else return s("/applications",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})},updateStatus:async(e,t)=>s(`/applications/${e}/status`,{method:"PATCH",body:JSON.stringify(t)}),delete:async e=>s(`/applications/${e}`,{method:"DELETE"}),getStats:async()=>s("/applications/stats/overview")},p="teacherAuthToken",S="teacherUser",g={getToken(){return localStorage.getItem(p)},setToken(e){localStorage.setItem(p,e)},clearToken(){localStorage.removeItem(p)},getUser(){const e=localStorage.getItem(S);if(!e)return null;try{return JSON.parse(e)}catch{return null}},setUser(e){localStorage.setItem(S,JSON.stringify(e))},clearUser(){localStorage.removeItem(S)}},o=async(e,t={})=>{const n=g.getToken(),r={"Content-Type":"application/json",...t.headers};n&&(r.Authorization=`Bearer ${n}`);const i=await fetch(`${h}${e}`,{...t,headers:r}),a=await i.json();if(!i.ok)throw new Error(a.message||"Request failed");return a},k={register:async e=>s("/teacher/auth/register",{method:"POST",body:JSON.stringify(e)}),login:async e=>{const t=await s("/teacher/auth/login",{method:"POST",body:JSON.stringify(e)});return t.success&&t.token&&t.teacher&&(g.setToken(t.token),g.setUser(t.teacher)),t},logout:()=>{g.clearToken(),g.clearUser()},getCurrentTeacher:async()=>o("/teacher/auth/me"),getStoredTeacher:()=>g.getUser(),isAuthenticated:()=>!!g.getToken()},P={list:async()=>s("/teacher/auth/admin/list"),updateStatus:async(e,t)=>s(`/teacher/auth/admin/${e}/status`,{method:"PATCH",body:JSON.stringify({status:t})})},N={list:async e=>{const t=e!=null&&e.teacherId?`?teacherId=${e.teacherId}`:"";return s(`/exams${t}`)},getQuestions:async e=>s(`/exams/${e}/questions`),submitAnswers:async(e,t)=>c(`/exams/${e}/submit`,{method:"POST",body:JSON.stringify(t)}),getResult:async(e,t)=>c(`/results/${e}/${t}`),getStudentHistory:async()=>c("/results/history")},U={list:async e=>{const t=e?`?teacherId=${e}`:"";return o(`/exams${t}`)},create:async e=>o("/exams",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>o(`/exams/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>o(`/exams/${e}`,{method:"DELETE"}),getManageDetail:async e=>o(`/exams/${e}/manage`),addQuestion:async(e,t)=>o(`/exams/${e}/questions`,{method:"POST",body:JSON.stringify(t)}),updateQuestion:async(e,t)=>o(`/exams/questions/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteQuestion:async e=>o(`/exams/questions/${e}`,{method:"DELETE"})},J={getStats:async()=>c("/student/analytics/stats"),getPerformance:async()=>c("/student/analytics/performance")},I={getHistory:async(e,t)=>{const n=e&&t?`?month=${e}&year=${t}`:"";return c(`/student/attendance${n}`)},getSummary:async()=>c("/student/attendance/summary")},_={getAll:async()=>c("/student/assignments"),getById:async e=>c(`/student/assignments/${e}`),submit:async(e,t)=>{const n=new FormData;n.append("file",t);const r=u.getToken(),i={};r&&(i.Authorization=`Bearer ${r}`);const a=await fetch(`${h}/student/assignments/${e}/submit`,{method:"POST",headers:i,body:n}),y=await a.json();if(!a.ok)throw new Error(y.message||"Submission failed");return y}},x={getAll:async()=>c("/student/notifications"),markRead:async e=>c(`/student/notifications/${e}/read`,{method:"PUT"}),markAllRead:async()=>c("/student/notifications/read-all",{method:"PUT"})},q={get:async()=>o("/teacher/stats/stats")},D={getAll:async()=>o("/teacher/students"),getById:async e=>o("/teacher/students/"+e)},R={getAll:async()=>o("/teacher/assignments"),create:async e=>{const t=g.getToken(),n={};t&&(n.Authorization=`Bearer ${t}`);const r=await fetch(`${h}/teacher/assignments`,{method:"POST",headers:n,body:e}),i=await r.json();if(!r.ok)throw new Error(i.message||"Creation failed");return i},getSubmissions:async e=>o(`/teacher/assignments/${e}/submissions`),gradeSubmission:async(e,t,n)=>o(`/teacher/assignments/submissions/${e}/grade`,{method:"POST",body:JSON.stringify({grade:t,feedback:n})})},j={mark:async(e,t)=>o("/teacher/attendance",{method:"POST",body:JSON.stringify({date:e,attendance:t})}),getHistory:async e=>{let t="";if(e){const n=[];e.date&&n.push(`date=${e.date}`),e.student_id&&n.push(`student_id=${e.student_id}`),n.length&&(t="?"+n.join("&"))}return o(`/teacher/attendance/history${t}`)}};export{h as A,E as a,w as b,J as c,_ as d,I as e,x as f,N as g,q as h,U as i,D as j,R as k,j as l,P as m,b as n,O as s,k as t};
