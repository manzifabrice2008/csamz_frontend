import{a as I,d as k,r as n,j as e}from"./index-CsgYaV5H.js";import{s as p}from"./api-BCzVkedE.js";import{S as A}from"./StudentLayout-DPOSCcME.js";import{B as y}from"./ThemeToggle-Bwx1KZ0R.js";import{I as o}from"./input-D_Mj_V6e.js";import{L as l}from"./label-seKkzqK9.js";import{C as N,a as S,b,d as C,c as _}from"./card-CIYtGjiO.js";import{S as P,a as L,b as F,c as D,d as u}from"./select-FJ4Obazy.js";import{L as h}from"./loader-circle-B_j-QHxK.js";import{U as B}from"./user-B0r-EK1A.js";import{M as V}from"./mail-BKI1ma0G.js";import{P as M}from"./phone-BSRWYK-w.js";import{S as Y}from"./save-p8Y7-kgH.js";import{L as x}from"./lock-B6UlrVva.js";import"./auth-yvpDPXXe.js";import"./avatar-CGuztETI.js";import"./index-DH-MU9K0.js";import"./settings-rizTttmP.js";import"./chevron-left-DXSgmS0_.js";import"./bell-CfzxW87c.js";import"./award-Bt5aB_n6.js";import"./index-BdQq_4o_.js";import"./index-DAQiBGYG.js";import"./chevron-up-Cgz--Hu-.js";const H=["Software Development","Computer Systems and Networks","Plumbing Technology","Building Construction","Wood Technology"];function pe(){I();const{toast:r}=k(),[U,E]=n.useState(!0),[d,c]=n.useState(!1),[j,f]=n.useState(""),[m,v]=n.useState(""),[g,w]=n.useState(""),[t,i]=n.useState({full_name:"",email:"",phone_number:"",trade:"",level:"L3"});n.useEffect(()=>{(async()=>{try{const a=await p.getCurrentStudent();a.success&&i({full_name:a.student.full_name||"",email:a.student.email||"",phone_number:a.student.phone_number||"",trade:a.student.trade||"",level:["L3","L4","L5"].includes(a.student.level)?a.student.level:"L3"})}catch(a){console.error("Failed to load student data:",a),r({title:"Error",description:"Failed to load your profile information.",variant:"destructive"})}finally{E(!1)}})()},[r]);const T=async s=>{s.preventDefault(),c(!0);try{await p.updateProfile({full_name:t.full_name.trim(),email:t.email.trim()||void 0,phone_number:t.phone_number.trim(),trade:t.trade,level:t.level}),r({title:"Success",description:"Your profile has been updated successfully."})}catch(a){console.error("Update error:",a),r({title:"Error",description:(a==null?void 0:a.message)||"Failed to update profile.",variant:"destructive"})}finally{c(!1)}},q=async s=>{if(s.preventDefault(),m.length<6){r({title:"Password too short",description:"Password must be at least 6 characters long.",variant:"destructive"});return}if(m!==g){r({title:"Passwords do not match",variant:"destructive"});return}c(!0);try{await p.changePassword({current_password:j,new_password:m}),r({title:"Success",description:"Your password has been updated successfully."}),f(""),v(""),w("")}catch(a){console.error("Password change error:",a),r({title:"Error",description:(a==null?void 0:a.message)||"Failed to update password.",variant:"destructive"})}finally{c(!1)}};return U?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(h,{className:"w-8 h-8 animate-spin"})}):e.jsx(A,{children:e.jsxs("div",{className:"container mx-auto p-4 space-y-6 max-w-4xl",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Account Settings"})}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(N,{children:[e.jsxs(S,{children:[e.jsx(b,{children:"Profile Information"}),e.jsx(C,{children:"Update your personal information and contact details."})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"full_name",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(o,{id:"full_name",value:t.full_name,onChange:s=>i({...t,full_name:s.target.value}),className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(o,{id:"email",type:"email",value:t.email,onChange:s=>i({...t,email:s.target.value}),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone_number",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(o,{id:"phone_number",type:"tel",value:t.phone_number,onChange:s=>i({...t,phone_number:s.target.value}),className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"trade",children:"Trade"}),e.jsxs(P,{value:t.trade,onValueChange:s=>i({...t,trade:s}),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select your trade"})}),e.jsx(D,{children:H.map(s=>e.jsx(u,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"level",children:"Level"}),e.jsxs(P,{value:t.level,onValueChange:s=>i({...t,level:s}),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select your level"})}),e.jsxs(D,{children:[e.jsx(u,{value:"L3",children:"Level 3"}),e.jsx(u,{value:"L4",children:"Level 4"}),e.jsx(u,{value:"L5",children:"Level 5"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(y,{type:"submit",disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})})]})})]}),e.jsxs(N,{children:[e.jsxs(S,{children:[e.jsx(b,{children:"Change Password"}),e.jsx(C,{children:"Update your password to keep your account secure."})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"current_password",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(o,{id:"current_password",type:"password",value:j,onChange:s=>f(s.target.value),className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"new_password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(o,{id:"new_password",type:"password",value:m,onChange:s=>v(s.target.value),className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"confirm_password",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(o,{id:"confirm_password",type:"password",value:g,onChange:s=>w(s.target.value),className:"pl-10",required:!0})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(y,{type:"submit",disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):"Update Password"})})]})})]})]})]})})}export{pe as default};
