import{c as B,b as E,a as q,u as I,r as o,j as e,L as l}from"./index-DO3DQyOj.js";import{L as u}from"./Layout-CrlmADHv.js";import{B as g}from"./badge-ikHMzMmi.js";import{B as i}from"./Combination-CmbmT9KT.js";import{C as h,a as p,b as j,d as f,c as N}from"./card-C9br3U49.js";import{S as M}from"./separator-iGe6MMcL.js";import{s as T,e as D}from"./api-D9lEpycP.js";import{L as $}from"./loader-circle-BtKAsjRv.js";import{A}from"./arrow-left-CW917cKp.js";import{T as P}from"./trophy-Cax9QrnQ.js";import{C as Q}from"./circle-check-ClT28XHX.js";import{C as _}from"./circle-x-D2iSncAj.js";import"./ThemeToggle-D7luiHAO.js";import"./index-B0Ri7ZjS.js";import"./globe-D0JlWi5d.js";import"./index-bF6N7R3r.js";import"./phone-Cfx4KfSj.js";import"./house-DEd3rU29.js";import"./square-pen-B3paAdo2.js";import"./image-BzTYbBvL.js";import"./user-CsuowrF_.js";import"./map-pin-D6wV0YeO.js";import"./auth-yvpDPXXe.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=B("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);function xe(){const{examId:s}=E(),r=q(),n=I(),[b,L]=o.useState(null),[R,y]=o.useState(!0),[v,C]=o.useState(null),a=o.useMemo(()=>T.getStoredStudent(),[]),d=n.state||null;if(o.useEffect(()=>{(async()=>{if(!s){C("Invalid exam id."),y(!1);return}if(!(a!=null&&a.id)){r("/student/login");return}try{const t=await D.getResult(a.id,Number(s));L(t)}catch(t){C((t==null?void 0:t.message)||"Unable to load result.")}finally{y(!1)}})()},[s,r,a==null?void 0:a.id]),R)return e.jsx(u,{children:e.jsx("section",{className:"py-16 px-4",children:e.jsx("div",{className:"container mx-auto flex justify-center py-20",children:e.jsx($,{className:"w-8 h-8 animate-spin text-school-primary"})})})});if(v)return e.jsx(u,{children:e.jsx("section",{className:"py-16 px-4",children:e.jsx("div",{className:"container mx-auto max-w-3xl space-y-6 text-center",children:e.jsxs(h,{className:"border-destructive/30",children:[e.jsxs(p,{children:[e.jsx(j,{className:"text-destructive",children:"Result unavailable"}),e.jsx(f,{children:v})]}),e.jsx(N,{children:e.jsxs(i,{variant:"outline",onClick:()=>r(-1),className:"inline-flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Back"]})})]})})})});if(!b)return null;const{exam:w,result:m,answers:k}=b,x=w.total_marks||k.reduce((c,t)=>c+t.marks,0),S=x>0?Math.round(m.score/x*100):0;return e.jsx(u,{children:e.jsx("section",{className:"py-16 px-4",children:e.jsxs("div",{className:"container mx-auto max-w-5xl space-y-8",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(g,{className:"bg-school-primary/10 text-school-primary dark:bg-school-accent/10 dark:text-school-accent",children:"Exam Result"}),e.jsx("h1",{className:"text-3xl font-bold gradient-text",children:w.title}),e.jsx("p",{className:"text-muted-foreground",children:"Review your score and question-by-question feedback below."})]}),e.jsxs(h,{className:"bg-gradient-to-br from-school-primary/10 via-background to-background shadow-xl border-school-primary/20",children:[e.jsxs(p,{className:"text-center space-y-3",children:[e.jsx(P,{className:"w-10 h-10 text-school-primary mx-auto"}),e.jsxs(j,{className:"text-4xl font-semibold",children:[m.score," / ",x]}),e.jsxs(f,{className:"text-base",children:[S,"% â€¢ Submitted on ",new Date(m.submitted_at).toLocaleString()]}),(d==null?void 0:d.fromSubmission)&&e.jsx(g,{variant:"secondary",className:"mx-auto",children:"Answers graded instantly!"})]}),e.jsxs(N,{className:"flex flex-col gap-3 sm:flex-row sm:justify-center",children:[e.jsx(i,{asChild:!0,variant:"default",children:e.jsx(l,{to:"/student/exams",children:"Back to exams"})}),e.jsx(i,{asChild:!0,variant:"outline",children:e.jsx(l,{to:`/student/exams/${s}`,children:"Retake exam"})})]})]}),e.jsxs(h,{className:"shadow-md",children:[e.jsxs(p,{children:[e.jsx(j,{children:"Question Feedback"}),e.jsx(f,{children:"Correct answers are highlighted for your review."})]}),e.jsx(M,{}),e.jsx(N,{className:"space-y-4",children:k.map((c,t)=>e.jsx(H,{answer:c,index:t},c.questionId))})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:justify-between",children:[e.jsx(i,{asChild:!0,variant:"ghost",className:"flex items-center gap-2",children:e.jsxs(l,{to:"/student/dashboard",children:[e.jsx(A,{className:"w-4 h-4"}),"Back to dashboard"]})}),e.jsx(i,{asChild:!0,className:"flex items-center gap-2",children:e.jsxs(l,{to:`/student/exams/${s}`,children:[e.jsx(F,{className:"w-4 h-4"}),"Try again"]})})]})]})})})}function H({answer:s,index:r}){const n=typeof s.studentAnswer=="string"&&s.studentAnswer.length>0;return e.jsx("div",{className:`rounded-lg border p-4 transition ${s.isCorrect?"border-emerald-200 bg-emerald-50 dark:border-emerald-400/40 dark:bg-emerald-400/10":"border-destructive/20 bg-destructive/5"}`,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Question ",r+1]}),e.jsxs(g,{variant:"outline",className:"font-mono",children:[s.marksAwarded,"/",s.marks," marks"]})]}),e.jsx("p",{className:"font-semibold text-lg",children:s.questionText}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.isCorrect?e.jsx(Q,{className:"w-4 h-4 text-emerald-500"}):e.jsx(_,{className:"w-4 h-4 text-destructive"}),e.jsx("span",{className:s.isCorrect?"text-emerald-600 dark:text-emerald-400":"text-destructive",children:s.isCorrect?"Correct":"Incorrect"})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Your answer:"})," ",n?s.studentAnswer:"No answer provided"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Correct answer:"})," ",s.correctAnswer]})]})]})})}export{xe as default};
