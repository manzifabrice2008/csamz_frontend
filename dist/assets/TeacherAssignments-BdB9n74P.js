import{c as R,r as i,j as e,d as C}from"./index-CzeJB2_e.js";import{T as B}from"./TeacherLayout-Otxn_IHj.js";import{A as y,k as f}from"./api-lJrYn1A1.js";import{B as r,a as T}from"./ThemeToggle-D2hc9s20.js";import{I as g}from"./input-BQrncYhx.js";import{T as S}from"./textarea-pwDqsI7c.js";import{D as k,a as D,b as A,c as L,d as F,e as _,f as I}from"./dialog-CkRlzZK3.js";import{C as M,a as P,b as V,d as $,c as q,e as z}from"./card-BsroX09w.js";import{L as l}from"./label-DD5LN0z1.js";import{S as O,a as U,b as W,c as J,d as h}from"./select-CWMO0rur.js";import{B as v}from"./badge-C-oA49Ek.js";import{S as K}from"./scroll-area-BUzgK9CA.js";import{F as w}from"./file-text-BxJWlFjv.js";import{P as Q}from"./plus-Ds6pyHzw.js";import{C as X}from"./calendar-DGQQ9pRT.js";import{U as Y}from"./users-Dg6TI95m.js";import{f as E}from"./format-SmSpYad1.js";import"./avatar-AnT28iLS.js";import"./index-CMcuwscu.js";import"./settings-Bfsz5ImR.js";import"./chevron-left-DDaN3q0X.js";import"./book-open-C9ZbQfPt.js";import"./user-CRAUHVsN.js";import"./auth-yvpDPXXe.js";import"./index-BdQq_4o_.js";import"./index-BtVmVfNa.js";import"./chevron-up-DxfnO0xg.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=R("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);function ee({onSelectAssignment:n}){const[d,x]=i.useState([]),[b,N]=i.useState(!0),{toast:o}=C(),[m,a]=i.useState(!1),c=async()=>{try{const t=await f.getAll();x(t.assignments)}catch{o({title:"Error",description:"Failed to load assignments",variant:"destructive"})}finally{N(!1)}};i.useEffect(()=>{c()},[]);const p=async t=>{t.preventDefault();const j=new FormData(t.currentTarget);try{await f.create(j),o({title:"Success",description:"Assignment created successfully"}),a(!1),c()}catch(s){o({title:"Error",description:s.message||"Failed to create assignment",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Assignments"}),e.jsx("p",{className:"text-muted-foreground",children:"Create and manage assignments for your students."})]}),e.jsxs(k,{open:m,onOpenChange:a,children:[e.jsx(I,{asChild:!0,children:e.jsxs(r,{children:[e.jsx(Q,{className:"mr-2 h-4 w-4"})," Create Assignment"]})}),e.jsxs(D,{className:"max-w-2xl",children:[e.jsxs(A,{children:[e.jsx(L,{children:"Create New Assignment"}),e.jsx(F,{children:"Post a new assignment for your students. Files are optional."})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"title",children:"Title"}),e.jsx(g,{id:"title",name:"title",required:!0,placeholder:"e.g., Weekly Project Report"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(S,{id:"description",name:"description",required:!0,placeholder:"Detailed instructions...",rows:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"deadline",children:"Deadline"}),e.jsx(g,{id:"deadline",name:"deadline",type:"datetime-local",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"level",children:"Level"}),e.jsxs(O,{name:"level",defaultValue:"L1",children:[e.jsx(U,{children:e.jsx(W,{placeholder:"Select level"})}),e.jsxs(J,{children:[e.jsx(h,{value:"L1",children:"Level 1"}),e.jsx(h,{value:"L2",children:"Level 2"}),e.jsx(h,{value:"L3",children:"Level 3"}),e.jsx(h,{value:"L4",children:"Level 4"}),e.jsx(h,{value:"L5",children:"Level 5"})]})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"file",children:"Attachment (Optional)"}),e.jsx(g,{id:"file",name:"file",type:"file"})]}),e.jsxs(_,{children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(r,{type:"submit",children:"Create Assignment"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:b?e.jsx("p",{children:"Loading..."}):d.length===0?e.jsx("p",{className:"text-muted-foreground col-span-full text-center py-10",children:"No assignments created yet."}):d.map(t=>e.jsxs(M,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>n(t.id),children:[e.jsxs(P,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(v,{variant:"outline",children:t.level}),new Date(t.deadline)<new Date&&e.jsx(v,{variant:"destructive",children:"Closed"})]}),e.jsx(V,{className:"mt-2 text-lg line-clamp-1",children:t.title}),e.jsx($,{className:"line-clamp-2",children:t.description})]}),e.jsx(q,{children:e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:E(new Date(t.deadline),"MMM d")})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.submission_count," Submitted"]})]})]})}),e.jsx(z,{className:"bg-muted/50 p-3",children:e.jsxs(r,{variant:"ghost",size:"sm",className:"w-full justify-between group",children:["View Submissions",e.jsx(T,{className:"h-4 w-4 opacity-50 group-hover:opacity-100 transition-opacity"})]})})]},t.id))})]})}function se({assignmentId:n,onBack:d}){var j;const[x,b]=i.useState([]),[N,o]=i.useState(!0),{toast:m}=C(),[a,c]=i.useState(null),p=async()=>{try{const s=await f.getSubmissions(n);b(s.submissions)}catch{m({title:"Error",description:"Failed to load submissions",variant:"destructive"})}finally{o(!1)}};i.useEffect(()=>{p()},[n]);const t=async s=>{s.preventDefault();const u=new FormData(s.currentTarget),G=Number(u.get("grade")),H=u.get("feedback");try{await f.gradeSubmission(a.id,G,H),m({title:"Success",description:"Submission graded"}),c(null),p()}catch{m({title:"Error",description:"Failed to submit grade",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:d,children:[e.jsx(T,{className:"h-4 w-4 rotate-180 mr-1"})," Back"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Assignment Submissions"}),e.jsx("p",{className:"text-muted-foreground",children:"Review and grade student work"})]})]}),e.jsx(k,{open:!!a,onOpenChange:s=>!s&&c(null),children:e.jsxs(D,{children:[e.jsxs(A,{children:[e.jsxs(L,{children:["Grade Submission: ",a==null?void 0:a.full_name]}),e.jsx(F,{children:"Enter grade and feedback for this student."})]}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Student File"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded text-sm bg-muted/50",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{className:"flex-1 truncate",children:(j=a==null?void 0:a.file_path)==null?void 0:j.split(/[/\\]/).pop()}),e.jsx(r,{size:"icon",variant:"ghost",type:"button",onClick:()=>{const s=y.replace(/\/api$/,"");window.open(`${s}/${a==null?void 0:a.file_path}`,"_blank")},children:e.jsx(Z,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"grade",children:"Grade (0-100)"}),e.jsx(g,{id:"grade",name:"grade",type:"number",min:"0",max:"100",defaultValue:a==null?void 0:a.grade,required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"feedback",children:"Feedback"}),e.jsx(S,{id:"feedback",name:"feedback",rows:3,defaultValue:a==null?void 0:a.feedback,placeholder:"Good work..."})]}),e.jsxs(_,{children:[e.jsx(r,{type:"button",variant:"ghost",onClick:()=>c(null),children:"Cancel"}),e.jsx(r,{type:"submit",children:"Submit Grade"})]})]})]})}),e.jsx("div",{className:"border rounded-md",children:e.jsx(K,{className:"h-[600px]",children:e.jsxs(Table,{children:[e.jsx(TableHeader,{children:e.jsxs(TableRow,{children:[e.jsx(TableHead,{children:"Student"}),e.jsx(TableHead,{children:"Submitted At"}),e.jsx(TableHead,{children:"File"}),e.jsx(TableHead,{children:"Grade"}),e.jsx(TableHead,{className:"text-right",children:"Action"})]})}),e.jsx(TableBody,{children:N?e.jsx(TableRow,{children:e.jsx(TableCell,{colSpan:5,className:"text-center",children:"Loading..."})}):x.length===0?e.jsx(TableRow,{children:e.jsx(TableCell,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No submissions yet."})}):x.map(s=>e.jsxs(TableRow,{children:[e.jsxs(TableCell,{children:[e.jsx("div",{className:"font-medium",children:s.full_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.email})]}),e.jsx(TableCell,{children:E(new Date(s.submitted_at),"MMM d, h:mm a")}),e.jsx(TableCell,{children:e.jsxs(r,{variant:"ghost",size:"sm",className:"h-8 gap-2",onClick:()=>{const u=y.replace(/\/api$/,"");window.open(`${u}/${s.file_path}`,"_blank")},children:[e.jsx(w,{className:"h-3 w-3"})," View"]})}),e.jsx(TableCell,{children:s.grade!==null?e.jsxs(v,{variant:s.grade>=50?"default":"destructive",children:[s.grade,"%"]}):e.jsx(v,{variant:"outline",className:"text-orange-500 border-orange-200",children:"Pending"})}),e.jsx(TableCell,{className:"text-right",children:e.jsx(r,{size:"sm",onClick:()=>c(s),children:s.grade!==null?"Update Grade":"Grade"})})]},s.id))})]})})})]})}function Le(){const[n,d]=i.useState(null);return e.jsx(B,{children:e.jsx("div",{className:"p-6",children:n?e.jsx(se,{assignmentId:n,onBack:()=>d(null)}):e.jsx(ee,{onSelectAssignment:d})})})}export{Le as default};
