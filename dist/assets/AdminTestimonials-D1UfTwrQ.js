import{d as B,r as a,j as e}from"./index-DO3DQyOj.js";import{A as L,M as v}from"./AdminLayout-BJsapQL8.js";import{C as N,c as T}from"./card-C9br3U49.js";import{B as c}from"./Combination-CmbmT9KT.js";import{B as p}from"./badge-ikHMzMmi.js";import{T as F,a as z,b as x,c as R}from"./tabs-DEG9O1Bk.js";import{D as O,a as I,b as M,c as P,d as q,e as H}from"./dialog-DyA2zykx.js";import{T as J}from"./textarea-DcEojWQk.js";import{L as U}from"./label-CNLbJ-lD.js";import{C as b}from"./circle-check-big-DR1ie-Ed.js";import{C as y}from"./circle-x-D2iSncAj.js";import{S as V}from"./star-BQSm7JUK.js";import{T as X}from"./trash-2-CYBM7sb9.js";import"./ThemeToggle-D7luiHAO.js";import"./auth-yvpDPXXe.js";import"./settings-C2rD9Q76.js";import"./chevron-left-Wbh9FitJ.js";import"./users-u0NU3Vz3.js";import"./square-pen-B3paAdo2.js";function pe(){const{toast:o}=B(),[u,C]=a.useState([]),[w,j]=a.useState(!0),[n,S]=a.useState("pending"),[i,A]=a.useState(null),[k,d]=a.useState(!1),[g,m]=a.useState(""),[r,D]=a.useState(null);a.useEffect(()=>{h()},[n]);const h=async()=>{j(!0);try{const s=localStorage.getItem("authToken"),t=await fetch(`http://localhost:5000/api/testimonials/status/${n}`,{headers:{Authorization:`Bearer ${s}`}});if(t.ok){const l=await t.json();C(l)}}catch(s){console.error("Error fetching testimonials:",s),o({title:"Error",description:"Failed to fetch testimonials",variant:"destructive"})}finally{j(!1)}},_=async()=>{if(!(!i||!r))try{const s=localStorage.getItem("authToken");(await fetch(`http://localhost:5000/api/testimonials/${i.id}/${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({admin_notes:g})})).ok&&(o({title:"Success",description:`Testimonial ${r}d successfully`}),d(!1),m(""),h())}catch(s){console.error("Error updating testimonial:",s),o({title:"Error",description:"Failed to update testimonial",variant:"destructive"})}},E=async s=>{if(confirm("Are you sure you want to delete this testimonial?"))try{const t=localStorage.getItem("authToken");(await fetch(`http://localhost:5000/api/testimonials/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok&&(o({title:"Success",description:"Testimonial deleted successfully"}),h())}catch(t){console.error("Error deleting testimonial:",t),o({title:"Error",description:"Failed to delete testimonial",variant:"destructive"})}},f=(s,t)=>{A(s),D(t),m(""),d(!0)},$=s=>e.jsx(N,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(T,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.program}),s.graduation_year&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Class of ",s.graduation_year]})]}),e.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((t,l)=>e.jsx(V,{className:`w-4 h-4 ${l<s.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},l))})]}),e.jsxs("p",{className:"text-muted-foreground mb-4 italic",children:['"',s.testimonial_text,'"']}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx(p,{variant:"outline",children:s.email}),s.phone_number&&e.jsx(p,{variant:"outline",children:s.phone_number}),e.jsx(p,{variant:s.status==="approved"?"default":s.status==="rejected"?"destructive":"secondary",children:s.status})]}),s.admin_notes&&e.jsxs("div",{className:"bg-muted p-3 rounded-md mb-4",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Admin Notes:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.admin_notes})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{size:"sm",onClick:()=>f(s,"approve"),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(b,{className:"w-4 h-4 mr-1"}),"Approve"]}),e.jsxs(c,{size:"sm",variant:"destructive",onClick:()=>f(s,"reject"),children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),"Reject"]})]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>E(s.id),children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Delete"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Submitted: ",new Date(s.created_at).toLocaleDateString()]})]})},s.id);return e.jsx(L,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Testimonials Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Review and manage student testimonials"})]}),e.jsxs(F,{value:n,onValueChange:S,className:"space-y-6",children:[e.jsxs(z,{children:[e.jsxs(x,{value:"pending",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Pending"]}),e.jsxs(x,{value:"approved",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Approved"]}),e.jsxs(x,{value:"rejected",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Rejected"]})]}),e.jsx(R,{value:n,children:w?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading testimonials..."})}):u.length===0?e.jsx(N,{children:e.jsxs(T,{className:"py-12 text-center",children:[e.jsx(v,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsxs("p",{className:"text-muted-foreground",children:["No ",n," testimonials found"]})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:u.map($)})})]}),e.jsx(O,{open:k,onOpenChange:d,children:e.jsxs(I,{children:[e.jsxs(M,{children:[e.jsxs(P,{children:[r==="approve"?"Approve":"Reject"," Testimonial"]}),e.jsx(q,{children:i&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold mt-2",children:i.full_name}),e.jsxs("p",{className:"text-sm italic mt-2",children:['"',i.testimonial_text,'"']})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(U,{htmlFor:"admin_notes",children:"Admin Notes (Optional)"}),e.jsx(J,{id:"admin_notes",value:g,onChange:s=>m(s.target.value),placeholder:"Add any notes about this decision...",rows:3})]})}),e.jsxs(H,{children:[e.jsx(c,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(c,{onClick:_,className:r==="approve"?"bg-green-600 hover:bg-green-700":"",variant:r==="reject"?"destructive":"default",children:r==="approve"?"Approve":"Reject"})]})]})})]})})}export{pe as default};
