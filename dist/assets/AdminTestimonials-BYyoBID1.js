import{d as L,r as a,j as e}from"./index-CsgYaV5H.js";import{A as F,M as N}from"./AdminLayout-2CmIMh1F.js";import{C as T,c as b}from"./card-CIYtGjiO.js";import{B as c}from"./ThemeToggle-Bwx1KZ0R.js";import{B as p}from"./badge-CpS_Z_D6.js";import{T as R,a as z,b as x,c as O}from"./tabs-DE9-j5cz.js";import{D as I,a as M,b as P,c as U,d as q,e as H}from"./dialog-B-aVVXUu.js";import{T as J}from"./textarea-CFS7NNN8.js";import{L as V}from"./label-seKkzqK9.js";import{A as u}from"./api-BCzVkedE.js";import{C as y}from"./circle-check-big--Bfa4Hy1.js";import{C}from"./circle-x-YpO7jBfk.js";import{S as X}from"./star-DV39TtCt.js";import{T as G}from"./trash-2-Rw-BK5zS.js";import"./auth-yvpDPXXe.js";import"./settings-rizTttmP.js";import"./chevron-left-DXSgmS0_.js";import"./users-Drmh8jIn.js";import"./newspaper-INFz-W6c.js";import"./square-pen-q17zO6lO.js";function ue(){const{toast:n}=L(),[j,w]=a.useState([]),[A,g]=a.useState(!0),[o,S]=a.useState("pending"),[i,_]=a.useState(null),[k,d]=a.useState(!1),[f,m]=a.useState(""),[r,D]=a.useState(null);a.useEffect(()=>{h()},[o]);const h=async()=>{g(!0);try{const s=localStorage.getItem("authToken"),t=await fetch(`${u}/testimonials/status/${o}`,{headers:{Authorization:`Bearer ${s}`}});if(t.ok){const l=await t.json();w(l)}}catch(s){console.error("Error fetching testimonials:",s),n({title:"Error",description:"Failed to fetch testimonials",variant:"destructive"})}finally{g(!1)}},E=async()=>{if(!(!i||!r))try{const s=localStorage.getItem("authToken");(await fetch(`${u}/testimonials/${i.id}/${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({admin_notes:f})})).ok&&(n({title:"Success",description:`Testimonial ${r}d successfully`}),d(!1),m(""),h())}catch(s){console.error("Error updating testimonial:",s),n({title:"Error",description:"Failed to update testimonial",variant:"destructive"})}},$=async s=>{if(confirm("Are you sure you want to delete this testimonial?"))try{const t=localStorage.getItem("authToken");(await fetch(`${u}/testimonials/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok&&(n({title:"Success",description:"Testimonial deleted successfully"}),h())}catch(t){console.error("Error deleting testimonial:",t),n({title:"Error",description:"Failed to delete testimonial",variant:"destructive"})}},v=(s,t)=>{_(s),D(t),m(""),d(!0)},B=s=>e.jsx(T,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.program}),s.graduation_year&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Class of ",s.graduation_year]})]}),e.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((t,l)=>e.jsx(X,{className:`w-4 h-4 ${l<s.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},l))})]}),e.jsxs("p",{className:"text-muted-foreground mb-4 italic",children:['"',s.testimonial_text,'"']}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx(p,{variant:"outline",children:s.email}),s.phone_number&&e.jsx(p,{variant:"outline",children:s.phone_number}),e.jsx(p,{variant:s.status==="approved"?"default":s.status==="rejected"?"destructive":"secondary",children:s.status})]}),s.admin_notes&&e.jsxs("div",{className:"bg-muted p-3 rounded-md mb-4",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Admin Notes:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.admin_notes})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{size:"sm",onClick:()=>v(s,"approve"),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),"Approve"]}),e.jsxs(c,{size:"sm",variant:"destructive",onClick:()=>v(s,"reject"),children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),"Reject"]})]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>$(s.id),children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),"Delete"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Submitted: ",new Date(s.created_at).toLocaleDateString()]})]})},s.id);return e.jsx(F,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Testimonials Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Review and manage student testimonials"})]}),e.jsxs(R,{value:o,onValueChange:S,className:"space-y-6",children:[e.jsxs(z,{children:[e.jsxs(x,{value:"pending",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Pending"]}),e.jsxs(x,{value:"approved",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Approved"]}),e.jsxs(x,{value:"rejected",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Rejected"]})]}),e.jsx(O,{value:o,children:A?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading testimonials..."})}):j.length===0?e.jsx(T,{children:e.jsxs(b,{className:"py-12 text-center",children:[e.jsx(N,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsxs("p",{className:"text-muted-foreground",children:["No ",o," testimonials found"]})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:j.map(B)})})]}),e.jsx(I,{open:k,onOpenChange:d,children:e.jsxs(M,{children:[e.jsxs(P,{children:[e.jsxs(U,{children:[r==="approve"?"Approve":"Reject"," Testimonial"]}),e.jsx(q,{children:i&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold mt-2",children:i.full_name}),e.jsxs("p",{className:"text-sm italic mt-2",children:['"',i.testimonial_text,'"']})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(V,{htmlFor:"admin_notes",children:"Admin Notes (Optional)"}),e.jsx(J,{id:"admin_notes",value:f,onChange:s=>m(s.target.value),placeholder:"Add any notes about this decision...",rows:3})]})}),e.jsxs(H,{children:[e.jsx(c,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(c,{onClick:E,className:r==="approve"?"bg-green-600 hover:bg-green-700":"",variant:r==="reject"?"destructive":"default",children:r==="approve"?"Approve":"Reject"})]})]})})]})})}export{ue as default};
