import{c as B,b as E,a as q,u as I,r as o,j as e,L as n}from"./index-CsgYaV5H.js";import{S as u}from"./StudentLayout-DPOSCcME.js";import{B as g}from"./badge-CpS_Z_D6.js";import{B as i}from"./ThemeToggle-Bwx1KZ0R.js";import{C as h,a as p,b as j,d as f,c as N}from"./card-CIYtGjiO.js";import{S as M}from"./separator-B7Dx_tm4.js";import{s as T,g as D}from"./api-BCzVkedE.js";import{L as $}from"./loader-circle-B_j-QHxK.js";import{A}from"./arrow-left-aUl2PMcJ.js";import{T as P}from"./trophy-Cj37sUKD.js";import{C as Q}from"./circle-check-DpA1qW7O.js";import{C as _}from"./circle-x-YpO7jBfk.js";import"./avatar-CGuztETI.js";import"./index-DH-MU9K0.js";import"./settings-rizTttmP.js";import"./chevron-left-DXSgmS0_.js";import"./bell-CfzxW87c.js";import"./user-B0r-EK1A.js";import"./award-Bt5aB_n6.js";import"./auth-yvpDPXXe.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=B("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);function ne(){const{examId:s}=E(),r=q(),d=I(),[b,R]=o.useState(null),[S,y]=o.useState(!0),[v,C]=o.useState(null),a=o.useMemo(()=>T.getStoredStudent(),[]),m=d.state||null;if(o.useEffect(()=>{(async()=>{if(!s){C("Invalid exam id."),y(!1);return}if(!(a!=null&&a.id)){r("/student/login");return}try{const t=await D.getResult(a.id,Number(s));R(t)}catch(t){C((t==null?void 0:t.message)||"Unable to load result.")}finally{y(!1)}})()},[s,r,a==null?void 0:a.id]),S)return e.jsx(u,{children:e.jsx("section",{className:"py-16 px-4",children:e.jsx("div",{className:"container mx-auto flex justify-center py-20",children:e.jsx($,{className:"w-8 h-8 animate-spin text-school-primary"})})})});if(v)return e.jsx(u,{children:e.jsx("section",{className:"py-16 px-4",children:e.jsx("div",{className:"container mx-auto max-w-3xl space-y-6 text-center",children:e.jsxs(h,{className:"border-destructive/30",children:[e.jsxs(p,{children:[e.jsx(j,{className:"text-destructive",children:"Result unavailable"}),e.jsx(f,{children:v})]}),e.jsx(N,{children:e.jsxs(i,{variant:"outline",onClick:()=>r(-1),className:"inline-flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Back"]})})]})})})});if(!b)return null;const{exam:w,result:l,answers:k}=b,x=w.total_marks||k.reduce((c,t)=>c+t.marks,0),L=x>0?Math.round(l.score/x*100):0;return e.jsx(u,{children:e.jsx("section",{className:"py-8 px-4",children:e.jsxs("div",{className:"container mx-auto max-w-5xl space-y-8",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(g,{className:"bg-school-primary/10 text-school-primary dark:bg-school-accent/10 dark:text-school-accent",children:"Exam Result"}),e.jsx("h1",{className:"text-3xl font-bold gradient-text",children:w.title}),e.jsx("p",{className:"text-muted-foreground",children:"Review your score and question-by-question feedback below."})]}),e.jsxs(h,{className:"bg-gradient-to-br from-school-primary/10 via-background to-background shadow-xl border-school-primary/20",children:[e.jsxs(p,{className:"text-center space-y-3",children:[e.jsx(P,{className:"w-10 h-10 text-school-primary mx-auto"}),e.jsxs(j,{className:"text-4xl font-semibold",children:[l.score," / ",x]}),e.jsxs(f,{className:"text-base",children:[L,"% • Grade: ",e.jsx("span",{className:"text-school-primary font-bold",children:l.grade||"N/A"})," • Submitted on ",new Date(l.submitted_at).toLocaleString()]}),(m==null?void 0:m.fromSubmission)&&e.jsx(g,{variant:"secondary",className:"mx-auto",children:"Answers graded instantly!"})]}),e.jsxs(N,{className:"flex flex-col gap-3 sm:flex-row sm:justify-center",children:[e.jsx(i,{asChild:!0,variant:"default",children:e.jsx(n,{to:"/student/exams",children:"Back to exams"})}),e.jsx(i,{asChild:!0,variant:"outline",children:e.jsx(n,{to:`/student/exams/${s}`,children:"Retake exam"})})]})]}),e.jsxs(h,{className:"shadow-md",children:[e.jsxs(p,{children:[e.jsx(j,{children:"Question Feedback"}),e.jsx(f,{children:"Correct answers are highlighted for your review."})]}),e.jsx(M,{}),e.jsx(N,{className:"space-y-4",children:k.map((c,t)=>e.jsx(G,{answer:c,index:t},c.questionId))})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:justify-between",children:[e.jsx(i,{asChild:!0,variant:"ghost",className:"flex items-center gap-2",children:e.jsxs(n,{to:"/student/dashboard",children:[e.jsx(A,{className:"w-4 h-4"}),"Back to dashboard"]})}),e.jsx(i,{asChild:!0,className:"flex items-center gap-2",children:e.jsxs(n,{to:`/student/exams/${s}`,children:[e.jsx(F,{className:"w-4 h-4"}),"Try again"]})})]})]})})})}function G({answer:s,index:r}){const d=typeof s.studentAnswer=="string"&&s.studentAnswer.length>0;return e.jsx("div",{className:`rounded-lg border p-4 transition ${s.isCorrect?"border-emerald-200 bg-emerald-50 dark:border-emerald-400/40 dark:bg-emerald-400/10":"border-destructive/20 bg-destructive/5"}`,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Question ",r+1]}),e.jsxs(g,{variant:"outline",className:"font-mono",children:[s.marksAwarded,"/",s.marks," marks"]})]}),e.jsx("p",{className:"font-semibold text-lg",children:s.questionText}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.isCorrect?e.jsx(Q,{className:"w-4 h-4 text-emerald-500"}):e.jsx(_,{className:"w-4 h-4 text-destructive"}),e.jsx("span",{className:s.isCorrect?"text-emerald-600 dark:text-emerald-400":"text-destructive",children:s.isCorrect?"Correct":"Incorrect"})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Your answer:"})," ",d?s.studentAnswer:"No answer provided"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Correct answer:"})," ",s.correctAnswer]})]})]})})}export{ne as default};
