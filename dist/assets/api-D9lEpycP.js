import{g as T,a as O}from"./auth-yvpDPXXe.js";const l="http://localhost:5000/api";async function s(e,t={}){var i;const n=T(),r={};!(t.body instanceof FormData)&&!((i=t.headers)!=null&&i["Content-Type"])&&(r["Content-Type"]="application/json"),n&&(r.Authorization=`Bearer ${n}`);try{const a=await fetch(`${l}${e}`,{...t,headers:{...r,...t.headers}}),S=a.headers.get("content-type");let c;if(S&&S.includes("application/json"))c=await a.json();else if(c=await a.text(),c)try{c=JSON.parse(c)}catch{}if(a.status===401)throw O(),window.location.href="/admin/login",new Error("Session expired. Please login again.");if(!a.ok)throw new Error(c&&c.message||typeof c=="string"&&c||`API request failed with status ${a.status}`);return c}catch(a){throw a instanceof Error?a:new Error("Network error. Please check your connection.")}}const b={getPublished:async()=>s("/blog"),getBySlug:async e=>s(`/blog/${e}`),adminList:async()=>s("/blog/admin"),adminGetById:async e=>s(`/blog/admin/${e}`),create:async e=>s("/blog",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>s(`/blog/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>s(`/blog/${e}`,{method:"DELETE"})},A={getAll:async()=>s("/news"),getById:async e=>s(`/news/${e}`),async create(e){const t={...e,image_urls:e.image_urls||[]};return s("/news",{method:"POST",body:JSON.stringify(t)})},async update(e,t){const n=t.image_urls?{...t,image_urls:t.image_urls}:t;return s(`/news/${e}`,{method:"PUT",body:JSON.stringify(n)})},delete:async e=>s(`/news/${e}`,{method:"DELETE"})},g="studentAuthToken",h="studentUser",o={getToken(){return localStorage.getItem(g)},setToken(e){localStorage.setItem(g,e)},clearToken(){localStorage.removeItem(g)},getUser(){const e=localStorage.getItem(h);if(!e)return null;try{return JSON.parse(e)}catch{return null}},setUser(e){localStorage.setItem(h,JSON.stringify(e))},clearUser(){localStorage.removeItem(h)}},y=async(e,t={})=>{const n=o.getToken(),r={"Content-Type":"application/json",...t.headers};n&&(r.Authorization=`Bearer ${n}`);const i=await fetch(`${l}${e}`,{...t,headers:r}),a=await i.json();if(!i.ok)throw new Error(a.message||"Request failed");return a},w={register:async e=>{const t=await s("/student/auth/register",{method:"POST",body:JSON.stringify(e)});return t.success&&(o.setToken(t.token),o.setUser(t.student)),t},login:async e=>{const t=await s("/student/auth/login",{method:"POST",body:JSON.stringify(e)});return t.success&&(o.setToken(t.token),o.setUser(t.student)),t},logout:()=>{o.clearToken(),o.clearUser()},getCurrentStudent:async()=>y("/student/auth/me"),getStoredStudent:()=>o.getUser(),isAuthenticated:()=>!!o.getToken(),updateProfile:async e=>{const t=await y("/student/profile",{method:"PATCH",body:JSON.stringify(e)});if(t.success){const n=o.getUser();n&&o.setUser({...n,...t.student})}return t},changePassword:async e=>y("/student/change-password",{method:"POST",body:JSON.stringify(e)})},f={getAll:async e=>{const t=new URLSearchParams;e!=null&&e.status&&t.append("status",e.status),e!=null&&e.program&&t.append("program",e.program);const n=t.toString();return s(`/applications${n?"?"+n:""}`)},getById:async e=>s(`/applications/${e}`),create:async e=>{if(e.report){const t=new FormData;return Object.entries(e).forEach(([n,r])=>{n!=="report"&&r!==void 0&&t.append(n,r)}),t.append("report",e.report),s("/applications",{method:"POST",body:t,headers:{}})}else return s("/applications",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})},updateStatus:async(e,t)=>s(`/applications/${e}/status`,{method:"PATCH",body:JSON.stringify(t)}),delete:async e=>s(`/applications/${e}`,{method:"DELETE"}),getStats:async()=>s("/applications/stats/overview")},N={list:async e=>{const t=new URLSearchParams;e!=null&&e.status&&t.append("status",e.status),e!=null&&e.upcoming&&t.append("upcoming",String(e.upcoming)),e!=null&&e.active&&t.append("active",String(e.active)),e!=null&&e.trade&&t.append("trade",e.trade);const n=t.toString();return s(`/holiday-assessments${n?`?${n}`:""}`)},create:async e=>s("/holiday-assessments",{method:"POST",body:JSON.stringify(e)}),getById:async e=>s(`/holiday-assessments/${e}`),update:async(e,t)=>s(`/holiday-assessments/${e}`,{method:"PUT",body:JSON.stringify(t)}),remove:async e=>s(`/holiday-assessments/${e}`,{method:"DELETE"}),addQuestion:async(e,t)=>s(`/holiday-assessments/${e}/questions`,{method:"POST",body:JSON.stringify(t)}),updateQuestion:async(e,t)=>s(`/holiday-assessments/questions/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteQuestion:async e=>s(`/holiday-assessments/questions/${e}`,{method:"DELETE"}),startAttempt:async(e,t)=>s(`/holiday-assessments/${e}/attempts`,{method:"POST",body:JSON.stringify(t)}),submitAttempt:async(e,t)=>s(`/holiday-assessments/attempts/${e}/submit`,{method:"POST",body:JSON.stringify(t)}),getAttempt:async e=>s(`/holiday-assessments/attempts/${e}`)},m="teacherAuthToken",p="teacherUser",u={getToken(){return localStorage.getItem(m)},setToken(e){localStorage.setItem(m,e)},clearToken(){localStorage.removeItem(m)},getUser(){const e=localStorage.getItem(p);if(!e)return null;try{return JSON.parse(e)}catch{return null}},setUser(e){localStorage.setItem(p,JSON.stringify(e))},clearUser(){localStorage.removeItem(p)}},d=async(e,t={})=>{const n=u.getToken(),r={"Content-Type":"application/json",...t.headers};n&&(r.Authorization=`Bearer ${n}`);const i=await fetch(`${l}${e}`,{...t,headers:r}),a=await i.json();if(!i.ok)throw new Error(a.message||"Request failed");return a},P={register:async e=>s("/teacher/auth/register",{method:"POST",body:JSON.stringify(e)}),login:async e=>{const t=await s("/teacher/auth/login",{method:"POST",body:JSON.stringify(e)});return t.success&&t.token&&t.teacher&&(u.setToken(t.token),u.setUser(t.teacher)),t},logout:()=>{u.clearToken(),u.clearUser()},getCurrentTeacher:async()=>d("/teacher/auth/me"),getStoredTeacher:()=>u.getUser(),isAuthenticated:()=>!!u.getToken()},U={list:async()=>s("/teacher/auth/admin/list"),updateStatus:async(e,t)=>s(`/teacher/auth/admin/${e}/status`,{method:"PATCH",body:JSON.stringify({status:t})})},k={list:async e=>{const t=e!=null&&e.teacherId?`?teacherId=${e.teacherId}`:"";return s(`/exams${t}`)},getQuestions:async e=>s(`/exams/${e}/questions`),submitAnswers:async(e,t)=>y(`/exams/${e}/submit`,{method:"POST",body:JSON.stringify(t)}),getResult:async(e,t)=>y(`/results/${e}/${t}`)},J={list:async e=>{const t=e?`?teacherId=${e}`:"";return d(`/exams${t}`)},create:async e=>d("/exams",{method:"POST",body:JSON.stringify(e)}),getManageDetail:async e=>d(`/exams/${e}/manage`),addQuestion:async(e,t)=>d(`/exams/${e}/questions`,{method:"POST",body:JSON.stringify(t)}),updateQuestion:async(e,t)=>d(`/exams/questions/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteQuestion:async e=>d(`/exams/questions/${e}`,{method:"DELETE"})};export{l as A,f as a,b,J as c,U as d,k as e,N as h,A as n,w as s,P as t};
